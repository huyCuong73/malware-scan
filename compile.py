import os
import yara

import jsonify

# Define the folder path containing YARA rules
folder_path = 'yara_rules'

# Initialize an empty rules object
compiled_rules = []

# Iterate through files in the folder
for filename in os.listdir(folder_path):
    if filename.endswith('.yar'):  # Filter for YARA rule files
        rule_file = os.path.join(folder_path, filename)

        try:
            # Compile the YARA rule and add it to the rules object
            rule = yara.compile(rule_file)
            print(rule)
            compiled_rules.append(rule)
            print(f"Compiled rule: {filename}")
        except yara.Error as e:
            print(f"Error compiling rule '{filename}': {e}")


try:

    for rule in compiled_rules:
        if(rule.match("malwares/Email-Worm/Anap.a.exe")):
            for r in rule:
                print(f"Matched rule: {r.name}")
            # print(f"Matched rule: {rule.size()}")
        
except yara.Error as e:
    print(f"Error scanning file: {e}")


