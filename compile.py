import os
import yara


folder_path = 'yara_rules'

print(os.listdir(folder_path))


def compileRules():
    compiled_rules = []

    for filename in os.listdir(folder_path):
        if filename.endswith('.yar'):  
            rule_file = os.path.join(folder_path, filename)

            try:
        
                rule = yara.compile(rule_file)
                print(rule)
                compiled_rules.append(rule) 
            except yara.Error as e:
                print(f"Error compiling rule '{filename}': {e}")

    return compiled_rules


# try:

#     for rule in compiled_rules:
#         if(rule.match("malwares/Joke/Avoid.exe")):
#             for r in rule:
#                 print(f"Matched rule: {r.metas}")


# except yara.Error as e:
#     print(f"Error scanning file: {e}")


